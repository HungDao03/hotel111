<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Qu·∫£n l√Ω tr·∫°ng th√°i ph√≤ng</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .room-card {
            cursor: pointer;
            transition: transform 0.2s ease-in-out;
        }

        .room-card:hover {
            transform: scale(1.02);
        }

        .room-status-TRONG {
            background-color: #d1e7dd;
            border-color: #0f5132;
        }

        .room-status-CO_NGUOI {
            background-color: #f8d7da;
            border-color: #842029;
        }
    </style>
</head>
<body>
<div class="container py-5">
    <h2 class="mb-4">üè® Danh s√°ch ph√≤ng</h2>
    <div class="row g-4" th:each="room : ${rooms}">
        <div class="col-md-3">
            <div class="card room-card"
                 th:classappend="'room-status-' + ${room.status.name()}"
                 th:data-bs-toggle="'modal'"
                 th:data-bs-target="'#roomDetailModal'"
                 th:attr="data-room-id=${room.id},
                          data-room-number=${room.roomNumber},
                          data-status=${room.status},
                          data-type=${room.roomType.name},
                          data-description=${room.roomType.description},
                          data-price=${room.roomType.pricePerNight},
                          data-tenant=${room.tenantName},
                          data-phone=${room.phoneNumber},
                          data-email=${room.email}">
                <div class="card-body text-center">
                    <h5 class="card-title" th:text="'Ph√≤ng ' + ${room.roomNumber}">Ph√≤ng 101</h5>
                    <p class="card-text" th:text="'Tr·∫°ng th√°i: ' + ${room.status}">TR·ªêNG</p>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal hi·ªÉn th·ªã chi ti·∫øt ph√≤ng -->
<div class="modal fade" id="roomDetailModal" tabindex="-1" aria-labelledby="roomModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Th√¥ng tin ph√≤ng</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="ƒê√≥ng"></button>
            </div>
            <div class="modal-body">
                <p><strong>S·ªë ph√≤ng:</strong> <span id="modalRoomNumber"></span></p>
                <p><strong>Tr·∫°ng th√°i:</strong> <span id="modalStatus"></span></p>
                <p><strong>Lo·∫°i ph√≤ng:</strong> <span id="modalType"></span></p>
                <p><strong>M√¥ t·∫£:</strong> <span id="modalDescription"></span></p>
                <p><strong>Gi√° m·ªói ƒë√™m:</strong> <span id="modalPrice"></span> VNƒê</p>
                <hr>
                <div id="tenantSection">
                    <p><strong>Ng∆∞·ªùi thu√™:</strong> <span id="modalTenant"></span></p>
                    <p><strong>ƒêi·ªán tho·∫°i:</strong> <span id="modalPhone"></span></p>
                    <p><strong>Email:</strong> <span id="modalEmail"></span></p>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
    const roomModal = document.getElementById('roomDetailModal');
    roomModal.addEventListener('show.bs.modal', function (event) {
        const card = event.relatedTarget;

        // L·∫•y d·ªØ li·ªáu t·ª´ thu·ªôc t√≠nh data
        const number = card.getAttribute('data-room-number');
        const status = card.getAttribute('data-status');
        const type = card.getAttribute('data-type');
        const desc = card.getAttribute('data-description');
        const price = card.getAttribute('data-price');
        const tenant = card.getAttribute('data-tenant');
        const phone = card.getAttribute('data-phone');
        const email = card.getAttribute('data-email');

        // G√°n v√†o modal
        document.getElementById('modalRoomNumber').textContent = number;
        document.getElementById('modalStatus').textContent = status;
        document.getElementById('modalType').textContent = type;
        document.getElementById('modalDescription').textContent = desc;
        document.getElementById('modalPrice').textContent = price;

        // G√°n ng∆∞·ªùi thu√™ n·∫øu c√≥
        if (status === 'CO_NGUOI') {
            document.getElementById('tenantSection').style.display = 'block';
            document.getElementById('modalTenant').textContent = tenant || 'Kh√¥ng r√µ';
            document.getElementById('modalPhone').textContent = phone || 'Kh√¥ng r√µ';
            document.getElementById('modalEmail').textContent = email || 'Kh√¥ng r√µ';
        } else {
            document.getElementById('tenantSection').style.display = 'none';
        }
    });
</script>
</body>
</html>
